// Este é o provider do nosso banco de dados
datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL") // Lê a URL de conexão do arquivo .env
}

// Bloco do gerador de cliente
generator client {
  provider = "prisma-client-js"
}

// Modelo para os usuários da aplicação
model Usuario {
  id              Int       @id @default(autoincrement())
  nome            String
  numero_registro String    @unique
  email           String    @unique
  senha           String

  // Relação: Um usuário pode criar muitos projetos
  projetos        Projeto[] @relation("CriadoPor") 
}

// Modelo para os montadores
model Montador {
  id              Int       @id @default(autoincrement())
  nome            String
  numero_registro String    @unique

  // Relação Muitos-para-Muitos: Um montador pode estar em muitos projetos
  projetos        Projeto[] @relation("ProjetoMontadores") 
}

// Modelo para os projetos
model Projeto {
  id              Int       @id @default(autoincrement())
  codigo_projeto  String    @unique 
  nome_empresa    String
  status          String
  descricao       String?
  data_cadastro   DateTime  @default(now()) 
  data_entrega    DateTime?

  // Relação com o usuário criador (Obrigatória)
  criadoPorId     Int
  criadoPor       Usuario   @relation("CriadoPor", fields: [criadoPorId], references: [id])

  // Relação Muitos-para-Muitos: Um projeto pode ter muitos montadores
  montadores      Montador[] @relation("ProjetoMontadores")

  // --- CORREÇÃO APLICADA AQUI ---
  // Campo de data de atualização com valor padrão para migração
  updatedAt       DateTime  @default(now()) @updatedAt 
}